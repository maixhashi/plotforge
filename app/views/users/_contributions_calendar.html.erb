<div class="contribution-calendar-container">
  <div class="contribution-calendar-title">
    作成したあらすじ<i class="fas fa-book-open"></i>
  </div>
  <!-- 月ラベルコンテナ -->
  <div class="months-container">
    <!-- 空白スペース（曜日ラベルの上部） -->
    <div></div>
    
    <!-- 月ラベルを略記で表示 -->
    <% (1..12).each do |month_index| %> 
      <div class="month-label" style="grid-column: span 4; text-align: center;">
        <%= month_index %>月
      </div>
    <% end %>
  </div>

  <div class="weekdays-and-days">
    <!-- 曜日ラベルコンテナ -->
    <div class="weekdays-container">
      <% %w[日 月 火 水 木 金 土].each do |day| %>
        <div class="day-label">
          <%= day %>
        </div>
      <% end %>
    </div>

    <!-- 日付コンテナ -->
    <div class="days-container">
      <!-- 1月1日までの空白を作成 -->
      <% first_weekday_of_year = Date.today.beginning_of_year.wday %>
      <% first_weekday_of_year.times do %>
        <div class="empty-day"></div>
      <% end %>

      <!-- カレンダーの日付を表示 -->
      <% start_date = Date.today.beginning_of_year %>
      <% end_date = Date.today.end_of_year %>
      <% (start_date..end_date).each do |date| %>
        <% count = @shuffled_overviews_count_by_date[date] || 0 %>
        <% color = case count
                    when 0 then "#ebedf0"
                    when 1..5 then "#c6e48b"
                    when 6..10 then "#7bc96f"
                    when 11..15 then "#239a3b"
                    else "#196127"
                  end %>
        <div class="day" style="background-color: <%= color %>;" title="<%= date %>: あらすじ <%= count %>つ"></div>
      <% end %>
    </div>
  </div>
</div>


<style>
.contribution-calendar-title {
  margin-left: 20px;
}

.contribution-calendar-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding-top: 10px;
  padding-bottom: 20px;
  padding-left: 10px;
}
  
.months-container {
  display: grid;
  grid-template-columns: repeat(53, 20px); /* 月を上部に並べる */
  grid-gap: 2px;
  margin-bottom: 5px; /* 月ラベルとカレンダー部分の間に余白を追加 */
  padding-top: 10px;
}

.weekdays-and-days {
  display: flex;
}

.weekdays-container {
  display: grid;
  grid-template-rows: repeat(7, 20px); /* 1列に曜日ラベル */
  grid-gap: 2px;
  margin-right: 5px; /* 曜日ラベルと日付の間に余白を追加 */
}

.days-container {
  display: grid;
  grid-auto-flow: column;
 grid-template-rows: repeat(7, 20px);
//  grid-template-columns: repeat(53, 20px); /* 日付を横に並べる */
  grid-gap: 2px;
}

.day-label {
  font-size: 16px;
  text-align: right;
}

.day {
  width: 20px;
  height: 20px;
  border-radius: 2px;
}

.empty-day {
  width: 20px;
  height: 20px;
  background-color: transparent;
}

.contribution-calendar-container .day:hover {
  opacity: 0.7;
  cursor: pointer;
}

</style>