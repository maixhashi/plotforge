console.log('destroy.js.erb');
document.querySelector('.bookmark-container').innerHTML = "<%= j render 'bookmark_add_button', user: current_user, shuffled_overview: @shuffled_overview %>";


document.addEventListener('DOMContentLoaded', () => {
  document.querySelectorAll('.bookmark-add-button, .bookmark-remove-button').forEach(button => {
    button.addEventListener('click', function(event) {
      event.preventDefault(); // デフォルトのリンクの動作を防ぐ

      const url = this.getAttribute('data-url');
      const method = this.classList.contains('bookmark-add-button') ? 'POST' : 'DELETE';
      const options = {
        method: method,
        headers: {
          'X-CSRF-Token': document.querySelector('meta[name="csrf-token"]').getAttribute('content'),
          'Content-Type': 'application/json'
        },
        body: method === 'POST' ? JSON.stringify({ shuffled_overview_id: this.getAttribute('data-shuffled-overview-id') }) : null
      };

      fetch(url, options)
        .then(response => response.text())
        .then(data => {
          if (response.ok) {
            // サーバーからのレスポンスでDOMを更新
            document.querySelector('.bookmark-container').innerHTML = data;
          } else {
            console.error('エラー:', response.statusText);
          }
        })
        .catch(error => console.error('Fetchエラー:', error));
    });
  });
});
